/*
  Class to return points and weights for Gaussian Quadrature
  
  Author: Komahan Boopathy (komahanboopathy@gmail.com)
*/

#include <stdio.h>
#include <math.h>
#include "GaussianQuadrature.h"

//===================================================================//
// Constructor and Destructor
//===================================================================//

/*
  Constructor
*/
GaussianQuadrature::GaussianQuadrature(){}

/*
  Destructor
*/
GaussianQuadrature::~GaussianQuadrature(){}


//===================================================================//
// Public functions
//===================================================================//

/*
  Return hermite quadrature points and weights
*/
void GaussianQuadrature::hermiteQuadrature(int npoints, 
                                           double mu, double sigma, 
                                           double *z, double *y, double *w){
  double x[npoints];
  if ( npoints == 1 ){
    // points
    x[0] = 0.0;
    // weights
    w[0] = 1.7724538509055159;
  } else if ( npoints == 2 ){
    // points
    x[0] = -0.7071067811865475;
    x[1] = 0.7071067811865475;
    // weights
    w[0] = 0.8862269254527579;
    w[1] = 0.8862269254527579;
  } else if ( npoints == 3 ){ 
    // points
    x[0] = -1.224744871391589;
    x[1] = 0.0;
    x[2] = 1.224744871391589;
    // weights
    w[0] = 0.2954089751509194;
    w[1] = 1.1816359006036772;
    w[2] = 0.2954089751509194;
  } else if ( npoints == 4 ){
    // points
    x[0] = -1.6506801238857847;
    x[1] = -0.5246476232752904;
    x[2] = 0.5246476232752904;
    x[3] = 1.6506801238857847;
    // weights
    w[0] = 0.08131283544724519;
    w[1] = 0.8049140900055127;
    w[2] = 0.8049140900055127;
    w[3] = 0.08131283544724519;
  } else if ( npoints == 5 ){
    // points
    x[0] = -2.0201828704560856;
    x[1] = -0.9585724646138185;
    x[2] = 0.0;
    x[3] = 0.9585724646138185;
    x[4] = 2.0201828704560856;
    // weights
    w[0] = 0.019953242059045917;
    w[1] = 0.3936193231522411;
    w[2] = 0.9453087204829418;
    w[3] = 0.3936193231522411;
    w[4] = 0.019953242059045917;
  } else if ( npoints == 6 ){
    // points
    x[0] = -2.3506049736744923;
    x[1] = -1.335849074013697;
    x[2] = -0.4360774119276165;
    x[3] = 0.4360774119276165;
    x[4] = 1.335849074013697;
    x[5] = 2.3506049736744923;
    // weights
    w[0] = 0.004530009905508835;
    w[1] = 0.15706732032285647;
    w[2] = 0.7246295952243924;
    w[3] = 0.7246295952243924;
    w[4] = 0.15706732032285647;
    w[5] = 0.004530009905508835;    
  } else if ( npoints == 7 ){
    // points
    x[0] = -2.6519613568352334;
    x[1] = -1.6735516287674714;
    x[2] = -0.8162878828589646;
    x[3] = 0.0;
    x[4] = 0.8162878828589646;
    x[5] = 1.6735516287674714;
    x[6] = 2.6519613568352334;
    // weights
    w[0] = 0.0009717812450995199;
    w[1] = 0.05451558281912705;
    w[2] = 0.4256072526101278;
    w[3] = 0.8102646175568072;
    w[4] = 0.4256072526101278;
    w[5] = 0.05451558281912705;
    w[6] = 0.0009717812450995199;
  } else if ( npoints == 8 ){
    // points
    x[0] = -2.930637420257244;
    x[1] = -1.981656756695843;
    x[2] = -1.1571937124467802;
    x[3] = -0.3811869902073221;
    x[4] = 0.3811869902073221;
    x[5] = 1.1571937124467802;
    x[6] = 1.981656756695843;
    x[7] = 2.930637420257244;    
    // weights
    w[0] = 0.00019960407221136783;
    w[1] = 0.017077983007413467;
    w[2] = 0.20780232581489183;
    w[3] = 0.6611470125582415;
    w[4] = 0.6611470125582415;
    w[5] = 0.20780232581489183;
    w[6] = 0.017077983007413467;
    w[7] = 0.00019960407221136783;
  } else if ( npoints == 9 ){
    // points
    x[0] = -3.1909932017815277;
    x[1] = -2.266580584531843;
    x[2] = -1.468553289216668;
    x[3] = -0.7235510187528376;
    x[4] = 0.0;
    x[5] = 0.7235510187528376;
    x[6] = 1.468553289216668;
    x[7] = 2.266580584531843;
    x[8] = 3.1909932017815277;
    // weights
    w[0] = 3.9606977263264365e-05;
    w[1] = 0.004943624275536941;
    w[2] = 0.08847452739437664;
    w[3] = 0.43265155900255564;
    w[4] = 0.720235215606051;
    w[5] = 0.43265155900255564;
    w[6] = 0.08847452739437664;
    w[7] = 0.004943624275536941;
    w[8] = 3.9606977263264365e-05;
  } else if ( npoints == 10 ){
    // points
    x[0] = -3.4361591188377374;
    x[1] = -2.5327316742327897;
    x[2] = -1.7566836492998816;
    x[3] = -1.0366108297895136;
    x[4] = -0.3429013272237046;
    x[5] = 0.3429013272237046;
    x[6] = 1.0366108297895136;
    x[7] = 1.7566836492998816;
    x[8] = 2.5327316742327897;
    x[9] = 3.4361591188377374;
    // weights
    w[0] = 7.640432855232641e-06;
    w[1] = 0.0013436457467812324;
    w[2] = 0.033874394455481106;
    w[3] = 0.2401386110823147;
    w[4] = 0.6108626337353258;
    w[5] = 0.6108626337353258;
    w[6] = 0.2401386110823147;
    w[7] = 0.033874394455481106;
    w[8] = 0.0013436457467812324;
    w[9] = 7.640432855232641e-06;
  } else if ( npoints == 11 ){
    x[0] = -3.6684708465595826;
    x[1] = -2.7832900997816514;
    x[2] = -2.0259480158257555;
    x[3] = -1.3265570844949328;
    x[4] = -0.6568095668820998;
    x[5] = 0.0;
    x[6] = 0.6568095668820998;
    x[7] = 1.3265570844949328;
    x[8] = 2.0259480158257555;
    x[9] = 2.7832900997816514;
    x[10] = 3.6684708465595826;

    w[0] = 1.4395603937142596e-06;
    w[1] = 0.00034681946632334544;
    w[2] = 0.011911395444911507;
    w[3] = 0.11722787516770851;
    w[4] = 0.42935975235612495;
    w[5] = 0.6547592869145916;
    w[6] = 0.42935975235612495;
    w[7] = 0.11722787516770851;
    w[8] = 0.011911395444911507;
    w[9] = 0.00034681946632334544;
    w[10] = 1.4395603937142596e-06;
  } else if ( npoints == 12 ){
    x[0] = -3.889724897869782;
    x[1] = -3.0206370251208896;
    x[2] = -2.2795070805010598;
    x[3] = -1.5976826351526048;
    x[4] = -0.9477883912401638;
    x[5] = -0.31424037625435913;
    x[6] = 0.31424037625435913;
    x[7] = 0.9477883912401638;
    x[8] = 1.5976826351526048;
    x[9] = 2.2795070805010598;
    x[10] = 3.0206370251208896;
    x[11] = 3.889724897869782;

    w[0] = 2.6585516843563044e-07;
    w[1] = 8.573687043587868e-05;
    w[2] = 0.00390539058462906;
    w[3] = 0.05160798561588398;
    w[4] = 0.2604923102641611;
    w[5] = 0.5701352362624795;
    w[6] = 0.5701352362624795;
    w[7] = 0.2604923102641611;
    w[8] = 0.05160798561588398;
    w[9] = 0.00390539058462906;
    w[10] = 8.573687043587868e-05;
    w[11] = 2.6585516843563044e-07;
  } else if ( npoints == 13 ){
    x[0] = -4.10133759617864;
    x[1] = -3.24660897837241;
    x[2] = -2.5197356856782376;
    x[3] = -1.853107651601512;
    x[4] = -1.2200550365907483;
    x[5] = -0.6057638791710601;
    x[6] = 0.0;
    x[7] = 0.6057638791710601;
    x[8] = 1.2200550365907483;
    x[9] = 1.853107651601512;
    x[10] = 2.5197356856782376;
    x[11] = 3.24660897837241;
    x[12] = 4.10133759617864;

    w[0] = 4.825731850073125e-08;
    w[1] = 2.0430360402707087e-05;
    w[2] = 0.001207459992719386;
    w[3] = 0.020862775296169953;
    w[4] = 0.1403233206870235;
    w[5] = 0.4216162968985432;
    w[6] = 0.6043931879211613;
    w[7] = 0.4216162968985432;
    w[8] = 0.1403233206870235;
    w[9] = 0.020862775296169953;
    w[10] = 0.001207459992719386;
    w[11] = 2.0430360402707087e-05;
    w[12] = 4.825731850073125e-08;
  } else if ( npoints == 14 ){
    x[0] = -4.304448570473632;
    x[1] = -3.4626569336022706;
    x[2] = -2.7484707249854026;
    x[3] = -2.0951832585077166;
    x[4] = -1.4766827311411408;
    x[5] = -0.8787137873293994;
    x[6] = -0.29174551067256205;
    x[7] = 0.29174551067256205;
    x[8] = 0.8787137873293994;
    x[9] = 1.4766827311411408;
    x[10] = 2.0951832585077166;
    x[11] = 2.7484707249854026;
    x[12] = 3.4626569336022706;
    x[13] = 4.304448570473632;

    w[0] = 8.628591168125132e-09;
    w[1] = 4.71648435501891e-06;
    w[2] = 0.00035509261355192297;
    w[3] = 0.007850054726457945;
    w[4] = 0.06850553422346528;
    w[5] = 0.2731056090642464;
    w[6] = 0.5364059097120901;
    w[7] = 0.5364059097120901;
    w[8] = 0.2731056090642464;
    w[9] = 0.06850553422346528;
    w[10] = 0.007850054726457945;
    w[11] = 0.00035509261355192297;
    w[12] = 4.71648435501891e-06;
    w[13] = 8.628591168125132e-09;
  } else if ( npoints == 15 ){
    x[0] = -4.499990707309392;
    x[1] = -3.6699503734044527;
    x[2] = -2.967166927905603;
    x[3] = -2.325732486173858;
    x[4] = -1.7199925751864888;
    x[5] = -1.1361155852109206;
    x[6] = -0.5650695832555758;
    x[7] = 0.0;
    x[8] = 0.5650695832555758;
    x[9] = 1.1361155852109206;
    x[10] = 1.7199925751864888;
    x[11] = 2.325732486173858;
    x[12] = 2.967166927905603;
    x[13] = 3.6699503734044527;
    x[14] = 4.499990707309392;

    w[0] = 1.522475804253521e-09;
    w[1] = 1.0591155477110625e-06;
    w[2] = 0.00010000444123249982;
    w[3] = 0.002778068842912775;
    w[4] = 0.0307800338725461;
    w[5] = 0.15848891579593571;
    w[6] = 0.4120286874988987;
    w[7] = 0.5641003087264174;
    w[8] = 0.4120286874988987;
    w[9] = 0.15848891579593571;
    w[10] = 0.0307800338725461;
    w[11] = 0.002778068842912775;
    w[12] = 0.00010000444123249982;
    w[13] = 1.0591155477110625e-06;
    w[14] = 1.522475804253521e-09;
  } else if ( npoints == 16 ){
    x[0] = -4.688738939305819;
    x[1] = -3.869447904860123;
    x[2] = -3.176999161979956;
    x[3] = -2.5462021578474814;
    x[4] = -1.9517879909162539;
    x[5] = -1.3802585391988809;
    x[6] = -0.8229514491446559;
    x[7] = -0.27348104613815244;
    x[8] = 0.27348104613815244;
    x[9] = 0.8229514491446559;
    x[10] = 1.3802585391988809;
    x[11] = 1.9517879909162539;
    x[12] = 2.5462021578474814;
    x[13] = 3.176999161979956;
    x[14] = 3.869447904860123;
    x[15] = 4.688738939305819;

    w[0] = 2.6548074740111673e-10;
    w[1] = 2.3209808448652032e-07;
    w[2] = 2.7118600925378892e-05;
    w[3] = 0.0009322840086241807;
    w[4] = 0.012880311535509989;
    w[5] = 0.08381004139898583;
    w[6] = 0.2806474585285337;
    w[7] = 0.5079294790166137;
    w[8] = 0.5079294790166137;
    w[9] = 0.2806474585285337;
    w[10] = 0.08381004139898583;
    w[11] = 0.012880311535509989;
    w[12] = 0.0009322840086241807;
    w[13] = 2.7118600925378892e-05;
    w[14] = 2.3209808448652032e-07;
    w[15] = 2.6548074740111673e-10;
  } else if ( npoints == 17 ){
    x[0] = -4.871345193674403;
    x[1] = -4.0619466758754745;
    x[2] = -3.378932091141494;
    x[3] = -2.7577629157038888;
    x[4] = -2.1735028266666205;
    x[5] = -1.6129243142212313;
    x[6] = -1.0676487257434506;
    x[7] = -0.5316330013426548;
    x[8] = 0.0;
    x[9] = 0.5316330013426548;
    x[10] = 1.0676487257434506;
    x[11] = 1.6129243142212313;
    x[12] = 2.1735028266666205;
    x[13] = 2.7577629157038888;
    x[14] = 3.378932091141494;
    x[15] = 4.0619466758754745;
    x[16] = 4.871345193674403;

    w[0] = 4.5805789307986096e-11;
    w[1] = 4.97707898163077e-08;
    w[2] = 7.112289140021293e-06;
    w[3] = 0.0002986432866977531;
    w[4] = 0.005067349957627545;
    w[5] = 0.04092003414975629;
    w[6] = 0.17264829767009698;
    w[7] = 0.40182646947041206;
    w[8] = 0.5309179376248635;
    w[9] = 0.40182646947041206;
    w[10] = 0.17264829767009698;
    w[11] = 0.04092003414975629;
    w[12] = 0.005067349957627545;
    w[13] = 0.0002986432866977531;
    w[14] = 7.112289140021293e-06;
    w[15] = 4.97707898163077e-08;
    w[16] = 4.5805789307986096e-11;
  } else if ( npoints == 18 ){
    x[0] = -5.048364008874467;
    x[1] = -4.248117873568127;
    x[2] = -3.573769068486266;
    x[3] = -2.961377505531607;
    x[4] = -2.3862990891666858;
    x[5] = -1.8355316042616288;
    x[6] = -1.3009208583896175;
    x[7] = -0.7766829192674116;
    x[8] = -0.2582677505190968;
    x[9] = 0.2582677505190968;
    x[10] = 0.7766829192674116;
    x[11] = 1.3009208583896175;
    x[12] = 1.8355316042616288;
    x[13] = 2.3862990891666858;
    x[14] = 2.961377505531607;
    x[15] = 3.573769068486266;
    x[16] = 4.248117873568127;
    x[17] = 5.048364008874467;

    w[0] = 7.828199772115908e-12;
    w[1] = 1.0467205795792089e-08;
    w[2] = 1.810654481093432e-06;
    w[3] = 9.18112686792939e-05;
    w[4] = 0.001888522630268417;
    w[5] = 0.018640042387544676;
    w[6] = 0.09730174764131541;
    w[7] = 0.2848072856699793;
    w[8] = 0.48349569472545567;
    w[9] = 0.48349569472545567;
    w[10] = 0.2848072856699793;
    w[11] = 0.09730174764131541;
    w[12] = 0.018640042387544676;
    w[13] = 0.001888522630268417;
    w[14] = 9.18112686792939e-05;
    w[15] = 1.810654481093432e-06;
    w[16] = 1.0467205795792089e-08;
    w[17] = 7.828199772115908e-12;
  } else if ( npoints == 19 ){
    x[0] = -5.220271690537482;
    x[1] = -4.428532806603779;
    x[2] = -3.76218735196402;
    x[3] = -3.157848818347602;
    x[4] = -2.591133789794543;
    x[5] = -2.049231709850619;
    x[6] = -1.5241706193935332;
    x[7] = -1.0103683871343114;
    x[8] = -0.5035201634238882;
    x[9] = 0.0;
    x[10] = 0.5035201634238882;
    x[11] = 1.0103683871343114;
    x[12] = 1.5241706193935332;
    x[13] = 2.049231709850619;
    x[14] = 2.591133789794543;
    x[15] = 3.157848818347602;
    x[16] = 3.76218735196402;
    x[17] = 4.428532806603779;
    x[18] = 5.220271690537482;

    w[0] = 1.3262970944985234e-12;
    w[1] = 2.163051009863575e-09;
    w[2] = 4.488243147223115e-07;
    w[3] = 2.7209197763161712e-05;
    w[4] = 0.0006708775214071804;
    w[5] = 0.007988866777723026;
    w[6] = 0.050810386909052006;
    w[7] = 0.1836327013069971;
    w[8] = 0.3916089886130303;
    w[9] = 0.5029748882761865;
    w[10] = 0.3916089886130303;
    w[11] = 0.1836327013069971;
    w[12] = 0.050810386909052006;
    w[13] = 0.007988866777723026;
    w[14] = 0.0006708775214071804;
    w[15] = 2.7209197763161712e-05;
    w[16] = 4.488243147223115e-07;
    w[17] = 2.163051009863575e-09;
    w[18] = 1.3262970944985234e-12;
  } else if ( npoints == 20 ){
    x[0] = -5.387480890011233;
    x[1] = -4.603682449550744;
    x[2] = -3.944764040115625;
    x[3] = -3.3478545673832163;
    x[4] = -2.7888060584281305;
    x[5] = -2.2549740020892757;
    x[6] = -1.7385377121165861;
    x[7] = -1.234076215395323;
    x[8] = -0.7374737285453944;
    x[9] = -0.24534070830090124;
    x[10] = 0.24534070830090124;
    x[11] = 0.7374737285453944;
    x[12] = 1.234076215395323;
    x[13] = 1.7385377121165861;
    x[14] = 2.2549740020892757;
    x[15] = 2.7888060584281305;
    x[16] = 3.3478545673832163;
    x[17] = 3.944764040115625;
    x[18] = 4.603682449550744;
    x[19] = 5.387480890011233;

    w[0] = 2.2293936455341447e-13;
    w[1] = 4.3993409922731747e-10;
    w[2] = 1.0860693707692782e-07;
    w[3] = 7.80255647853206e-06;
    w[4] = 0.00022833863601635365;
    w[5] = 0.0032437733422378567;
    w[6] = 0.024810520887463643;
    w[7] = 0.1090172060200233;
    w[8] = 0.28667550536283415;
    w[9] = 0.4622436696006101;
    w[10] = 0.4622436696006101;
    w[11] = 0.28667550536283415;
    w[12] = 0.1090172060200233;
    w[13] = 0.024810520887463643;
    w[14] = 0.0032437733422378567;
    w[15] = 0.00022833863601635365;
    w[16] = 7.80255647853206e-06;
    w[17] = 1.0860693707692782e-07;
    w[18] = 4.3993409922731747e-10;
    w[19] = 2.2293936455341447e-13;
  } else {
    printf("Error: Implement Hermite quadrature points\n");
    exit(-1);
  }

  // Return points in appropriate domains
  for ( int n = 0; n < npoints; n++ ) {
    y[n] = mu + sigma*sqrt(2.0)*x[n];
    z[n] = (y[n] - mu)/sigma;
    w[n] = w[n]/sqrt(4.0*atan(1.0));
  }
}

/*
  Return legendre quadrature points and weights
*/
void GaussianQuadrature::legendreQuadrature(int npoints, 
                                            double a, double b, 
                                            double *z, double *y, double *w){
  double x[npoints];
  if ( npoints == 1 ){
    // points
    x[0] = 0.0;
    // weights
    w[0] = 2.0;
  } else if ( npoints == 2 ){
    // points
    x[0] = -0.5773502691896257;
    x[1] = 0.5773502691896257;
    // weights
    w[0] = 1.0;
    w[1] = 1.0;
  } else if ( npoints == 3 ){
    // points
    x[0] = -0.7745966692414834;
    x[1] = 0.0;
    x[2] = 0.7745966692414834;
    // weights
    w[0] = 0.5555555555555557;
    w[1] = 0.8888888888888888;
    w[2] = 0.5555555555555557;
  } else if ( npoints == 4 ){
    // points
    x[0] = -0.8611363115940526;
    x[1] = -0.33998104358485626;
    x[2] = 0.33998104358485626;
    x[3] = 0.8611363115940526;
    // weights
    w[0] = 0.3478548451374537;
    w[1] = 0.6521451548625462;
    w[2] = 0.6521451548625462;
    w[3] = 0.3478548451374537;
  } else if ( npoints == 5 ){
    // points
    x[0] = -0.906179845938664;
    x[1] = -0.5384693101056831;
    x[2] = 0.0;
    x[3] = 0.5384693101056831;
    x[4] = 0.906179845938664;
    // weights
    w[0] = 0.23692688505618942;
    w[1] = 0.4786286704993662;
    w[2] = 0.568888888888889;
    w[3] = 0.4786286704993662;
    w[4] = 0.23692688505618942;
  } else if ( npoints == 6 ){
    // points
    x[0] = -0.932469514203152;
    x[1] = -0.6612093864662645;
    x[2] = -0.23861918608319693;
    x[3] = 0.23861918608319693;
    x[4] = 0.6612093864662645;
    x[5] = 0.932469514203152;
    // weights
    w[0] = 0.17132449237916975;
    w[1] = 0.36076157304813894;
    w[2] = 0.46791393457269137;
    w[3] = 0.46791393457269137;
    w[4] = 0.36076157304813894;
    w[5] = 0.17132449237916975;
  } else if ( npoints == 7 ){
    // points
    x[0] = -0.9491079123427585;
    x[1] = -0.7415311855993945;
    x[2] = -0.4058451513773972;
    x[3] = 0.0;
    x[4] = 0.4058451513773972;
    x[5] = 0.7415311855993945;
    x[6] = 0.9491079123427585;
    // weights
    w[0] = 0.12948496616887065;
    w[1] = 0.2797053914892766;
    w[2] = 0.3818300505051183;
    w[3] = 0.41795918367346896;
    w[4] = 0.3818300505051183;
    w[5] = 0.2797053914892766;
    w[6] = 0.12948496616887065;
  } else if ( npoints == 8 ){
    // points
    x[0] = -0.9602898564975362;
    x[1] = -0.7966664774136267;
    x[2] = -0.525532409916329;
    x[3] = -0.18343464249564978;
    x[4] = 0.18343464249564978;
    x[5] = 0.525532409916329;
    x[6] = 0.7966664774136267;
    x[7] = 0.9602898564975362;
    // weights
    w[0] = 0.10122853629037669;
    w[1] = 0.22238103445337434;
    w[2] = 0.31370664587788705;
    w[3] = 0.36268378337836177;
    w[4] = 0.36268378337836177;
    w[5] = 0.31370664587788705;
    w[6] = 0.22238103445337434;
    w[7] = 0.10122853629037669;
  } else if ( npoints == 9 ){
    // points
    x[0] = -0.9681602395076261;
    x[1] = -0.8360311073266358;
    x[2] = -0.6133714327005904;
    x[3] = -0.3242534234038089;
    x[4] = 0.0;
    x[5] = 0.3242534234038089;
    x[6] = 0.6133714327005904;
    x[7] = 0.8360311073266358;
    x[8] = 0.9681602395076261;
    // weights
    w[0] = 0.08127438836157472;
    w[1] = 0.18064816069485712;
    w[2] = 0.26061069640293566;
    w[3] = 0.3123470770400028;
    w[4] = 0.33023935500125967;
    w[5] = 0.3123470770400028;
    w[6] = 0.26061069640293566;
    w[7] = 0.18064816069485712;
    w[8] = 0.08127438836157472;
  } else if ( npoints == 10 ){
    // points
    x[0] = -0.9739065285171717;
    x[1] = -0.8650633666889845;
    x[2] = -0.6794095682990244;
    x[3] = -0.4333953941292472;
    x[4] = -0.14887433898163122;
    x[5] = 0.14887433898163122;
    x[6] = 0.4333953941292472;
    x[7] = 0.6794095682990244;
    x[8] = 0.8650633666889845;
    x[9] = 0.9739065285171717;
    // weights
    w[0] = 0.06667134430868807;
    w[1] = 0.14945134915058036;
    w[2] = 0.219086362515982;
    w[3] = 0.2692667193099965;
    w[4] = 0.295524224714753;
    w[5] = 0.295524224714753;
    w[6] = 0.2692667193099965;
    w[7] = 0.219086362515982;
    w[8] = 0.14945134915058036;
    w[9] = 0.06667134430868807;
  } else if ( npoints == 11 ){

    x[0] = -0.978228658146057;
    x[1] = -0.8870625997680953;
    x[2] = -0.7301520055740494;
    x[3] = -0.5190961292068118;
    x[4] = -0.26954315595234496;
    x[5] = 0.0;
    x[6] = 0.26954315595234496;
    x[7] = 0.5190961292068118;
    x[8] = 0.7301520055740494;
    x[9] = 0.8870625997680953;
    x[10] = 0.978228658146057;

    w[0] = 0.055668567116173164;
    w[1] = 0.1255803694649047;
    w[2] = 0.18629021092773443;
    w[3] = 0.23319376459199068;
    w[4] = 0.26280454451024676;
    w[5] = 0.2729250867779009;
    w[6] = 0.26280454451024676;
    w[7] = 0.23319376459199068;
    w[8] = 0.18629021092773443;
    w[9] = 0.1255803694649047;
    w[10] = 0.055668567116173164;

  } else if ( npoints == 12 ){

    x[0] = -0.9815606342467192;
    x[1] = -0.9041172563704748;
    x[2] = -0.7699026741943047;
    x[3] = -0.5873179542866175;
    x[4] = -0.3678314989981802;
    x[5] = -0.1252334085114689;
    x[6] = 0.1252334085114689;
    x[7] = 0.3678314989981802;
    x[8] = 0.5873179542866175;
    x[9] = 0.7699026741943047;
    x[10] = 0.9041172563704748;
    x[11] = 0.9815606342467192;

    w[0] = 0.04717533638651202;
    w[1] = 0.10693932599531888;
    w[2] = 0.1600783285433461;
    w[3] = 0.20316742672306565;
    w[4] = 0.23349253653835464;
    w[5] = 0.2491470458134027;
    w[6] = 0.2491470458134027;
    w[7] = 0.23349253653835464;
    w[8] = 0.20316742672306565;
    w[9] = 0.1600783285433461;
    w[10] = 0.10693932599531888;
    w[11] = 0.04717533638651202;

  } else if ( npoints == 13 ){

    x[0] = -0.9841830547185881;
    x[1] = -0.9175983992229779;
    x[2] = -0.8015780907333099;
    x[3] = -0.6423493394403402;
    x[4] = -0.4484927510364468;
    x[5] = -0.23045831595513477;
    x[6] = 0.0;
    x[7] = 0.23045831595513477;
    x[8] = 0.4484927510364468;
    x[9] = 0.6423493394403402;
    x[10] = 0.8015780907333099;
    x[11] = 0.9175983992229779;
    x[12] = 0.9841830547185881;

    w[0] = 0.04048400476531588;
    w[1] = 0.0921214998377286;
    w[2] = 0.13887351021978736;
    w[3] = 0.17814598076194552;
    w[4] = 0.20781604753688857;
    w[5] = 0.22628318026289715;
    w[6] = 0.2325515532308739;
    w[7] = 0.22628318026289715;
    w[8] = 0.20781604753688857;
    w[9] = 0.17814598076194552;
    w[10] = 0.13887351021978736;
    w[11] = 0.0921214998377286;
    w[12] = 0.04048400476531588;

  } else if ( npoints == 14 ){

    x[0] = -0.9862838086968123;
    x[1] = -0.9284348836635735;
    x[2] = -0.827201315069765;
    x[3] = -0.6872929048116855;
    x[4] = -0.5152486363581541;
    x[5] = -0.31911236892788974;
    x[6] = -0.10805494870734367;
    x[7] = 0.10805494870734367;
    x[8] = 0.31911236892788974;
    x[9] = 0.5152486363581541;
    x[10] = 0.6872929048116855;
    x[11] = 0.827201315069765;
    x[12] = 0.9284348836635735;
    x[13] = 0.9862838086968123;

    w[0] = 0.035119460331752374;
    w[1] = 0.0801580871597603;
    w[2] = 0.12151857068790296;
    w[3] = 0.1572031671581934;
    w[4] = 0.18553839747793763;
    w[5] = 0.20519846372129555;
    w[6] = 0.21526385346315766;
    w[7] = 0.21526385346315766;
    w[8] = 0.20519846372129555;
    w[9] = 0.18553839747793763;
    w[10] = 0.1572031671581934;
    w[11] = 0.12151857068790296;
    w[12] = 0.0801580871597603;
    w[13] = 0.035119460331752374;

  } else if ( npoints == 15 ){

    x[0] = -0.9879925180204854;
    x[1] = -0.937273392400706;
    x[2] = -0.8482065834104272;
    x[3] = -0.7244177313601701;
    x[4] = -0.5709721726085388;
    x[5] = -0.3941513470775634;
    x[6] = -0.20119409399743451;
    x[7] = 0.0;
    x[8] = 0.20119409399743451;
    x[9] = 0.3941513470775634;
    x[10] = 0.5709721726085388;
    x[11] = 0.7244177313601701;
    x[12] = 0.8482065834104272;
    x[13] = 0.937273392400706;
    x[14] = 0.9879925180204854;

    w[0] = 0.030753241996118647;
    w[1] = 0.07036604748810807;
    w[2] = 0.10715922046717177;
    w[3] = 0.1395706779261539;
    w[4] = 0.16626920581699378;
    w[5] = 0.18616100001556188;
    w[6] = 0.19843148532711125;
    w[7] = 0.2025782419255609;
    w[8] = 0.19843148532711125;
    w[9] = 0.18616100001556188;
    w[10] = 0.16626920581699378;
    w[11] = 0.1395706779261539;
    w[12] = 0.10715922046717177;
    w[13] = 0.07036604748810807;
    w[14] = 0.030753241996118647;

  } else if ( npoints == 16 ){

    x[0] = -0.9894009349916499;
    x[1] = -0.9445750230732326;
    x[2] = -0.8656312023878318;
    x[3] = -0.755404408355003;
    x[4] = -0.6178762444026438;
    x[5] = -0.45801677765722737;
    x[6] = -0.2816035507792589;
    x[7] = -0.09501250983763745;
    x[8] = 0.09501250983763745;
    x[9] = 0.2816035507792589;
    x[10] = 0.45801677765722737;
    x[11] = 0.6178762444026438;
    x[12] = 0.755404408355003;
    x[13] = 0.8656312023878318;
    x[14] = 0.9445750230732326;
    x[15] = 0.9894009349916499;

    w[0] = 0.027152459411754037;
    w[1] = 0.062253523938647706;
    w[2] = 0.09515851168249259;
    w[3] = 0.12462897125553403;
    w[4] = 0.14959598881657676;
    w[5] = 0.16915651939500262;
    w[6] = 0.1826034150449236;
    w[7] = 0.18945061045506859;
    w[8] = 0.18945061045506859;
    w[9] = 0.1826034150449236;
    w[10] = 0.16915651939500262;
    w[11] = 0.14959598881657676;
    w[12] = 0.12462897125553403;
    w[13] = 0.09515851168249259;
    w[14] = 0.062253523938647706;
    w[15] = 0.027152459411754037;

  } else if ( npoints == 17 ){

    x[0] = -0.9905754753144174;
    x[1] = -0.9506755217687678;
    x[2] = -0.8802391537269859;
    x[3] = -0.7815140038968014;
    x[4] = -0.6576711592166908;
    x[5] = -0.5126905370864769;
    x[6] = -0.3512317634538763;
    x[7] = -0.17848418149584785;
    x[8] = 0.0;
    x[9] = 0.17848418149584785;
    x[10] = 0.3512317634538763;
    x[11] = 0.5126905370864769;
    x[12] = 0.6576711592166908;
    x[13] = 0.7815140038968014;
    x[14] = 0.8802391537269859;
    x[15] = 0.9506755217687678;
    x[16] = 0.9905754753144174;

    w[0] = 0.02414830286854952;
    w[1] = 0.0554595293739866;
    w[2] = 0.08503614831717908;
    w[3] = 0.11188384719340365;
    w[4] = 0.13513636846852523;
    w[5] = 0.15404576107681012;
    w[6] = 0.16800410215644995;
    w[7] = 0.17656270536699253;
    w[8] = 0.17944647035620653;
    w[9] = 0.17656270536699253;
    w[10] = 0.16800410215644995;
    w[11] = 0.15404576107681012;
    w[12] = 0.13513636846852523;
    w[13] = 0.11188384719340365;
    w[14] = 0.08503614831717908;
    w[15] = 0.0554595293739866;
    w[16] = 0.02414830286854952;

  } else if ( npoints == 18 ){

    x[0] = -0.9915651684209309;
    x[1] = -0.9558239495713978;
    x[2] = -0.8926024664975557;
    x[3] = -0.8037049589725231;
    x[4] = -0.6916870430603532;
    x[5] = -0.5597708310739475;
    x[6] = -0.41175116146284263;
    x[7] = -0.2518862256915055;
    x[8] = -0.08477501304173529;
    x[9] = 0.08477501304173529;
    x[10] = 0.2518862256915055;
    x[11] = 0.41175116146284263;
    x[12] = 0.5597708310739475;
    x[13] = 0.6916870430603532;
    x[14] = 0.8037049589725231;
    x[15] = 0.8926024664975557;
    x[16] = 0.9558239495713978;
    x[17] = 0.9915651684209309;

    w[0] = 0.02161601352648413;
    w[1] = 0.04971454889496922;
    w[2] = 0.07642573025488925;
    w[3] = 0.10094204410628699;
    w[4] = 0.12255520671147836;
    w[5] = 0.14064291467065063;
    w[6] = 0.15468467512626521;
    w[7] = 0.16427648374583273;
    w[8] = 0.16914238296314363;
    w[9] = 0.16914238296314363;
    w[10] = 0.16427648374583273;
    w[11] = 0.15468467512626521;
    w[12] = 0.14064291467065063;
    w[13] = 0.12255520671147836;
    w[14] = 0.10094204410628699;
    w[15] = 0.07642573025488925;
    w[16] = 0.04971454889496922;
    w[17] = 0.02161601352648413;

  } else if ( npoints == 19 ){

    x[0] = -0.9924068438435844;
    x[1] = -0.96020815213483;
    x[2] = -0.9031559036148179;
    x[3] = -0.8227146565371428;
    x[4] = -0.7209661773352294;
    x[5] = -0.600545304661681;
    x[6] = -0.46457074137596094;
    x[7] = -0.31656409996362983;
    x[8] = -0.1603586456402254;
    x[9] = 0.0;
    x[10] = 0.1603586456402254;
    x[11] = 0.31656409996362983;
    x[12] = 0.46457074137596094;
    x[13] = 0.600545304661681;
    x[14] = 0.7209661773352294;
    x[15] = 0.8227146565371428;
    x[16] = 0.9031559036148179;
    x[17] = 0.96020815213483;
    x[18] = 0.9924068438435844;

    w[0] = 0.01946178822972761;
    w[1] = 0.04481422676569981;
    w[2] = 0.06904454273764107;
    w[3] = 0.09149002162244985;
    w[4] = 0.11156664554733375;
    w[5] = 0.1287539625393362;
    w[6] = 0.14260670217360638;
    w[7] = 0.15276604206585945;
    w[8] = 0.15896884339395415;
    w[9] = 0.16105444984878345;
    w[10] = 0.15896884339395415;
    w[11] = 0.15276604206585945;
    w[12] = 0.14260670217360638;
    w[13] = 0.1287539625393362;
    w[14] = 0.11156664554733375;
    w[15] = 0.09149002162244985;
    w[16] = 0.06904454273764107;
    w[17] = 0.04481422676569981;
    w[18] = 0.01946178822972761;

  } else if ( npoints == 20 ){

    x[0] = -0.9931285991850949;
    x[1] = -0.9639719272779138;
    x[2] = -0.9122344282513258;
    x[3] = -0.8391169718222188;
    x[4] = -0.7463319064601508;
    x[5] = -0.636053680726515;
    x[6] = -0.5108670019508271;
    x[7] = -0.37370608871541955;
    x[8] = -0.2277858511416451;
    x[9] = -0.07652652113349734;
    x[10] = 0.07652652113349734;
    x[11] = 0.2277858511416451;
    x[12] = 0.37370608871541955;
    x[13] = 0.5108670019508271;
    x[14] = 0.636053680726515;
    x[15] = 0.7463319064601508;
    x[16] = 0.8391169718222188;
    x[17] = 0.9122344282513258;
    x[18] = 0.9639719272779138;
    x[19] = 0.9931285991850949;

    w[0] = 0.017614007139153273;
    w[1] = 0.04060142980038622;
    w[2] = 0.06267204833410944;
    w[3] = 0.08327674157670467;
    w[4] = 0.10193011981724026;
    w[5] = 0.11819453196151825;
    w[6] = 0.13168863844917653;
    w[7] = 0.14209610931838187;
    w[8] = 0.14917298647260366;
    w[9] = 0.15275338713072578;
    w[10] = 0.15275338713072578;
    w[11] = 0.14917298647260366;
    w[12] = 0.14209610931838187;
    w[13] = 0.13168863844917653;
    w[14] = 0.11819453196151825;
    w[15] = 0.10193011981724026;
    w[16] = 0.08327674157670467;
    w[17] = 0.06267204833410944;
    w[18] = 0.04060142980038622;
    w[19] = 0.017614007139153273;

  } else {
    printf("Error: Implement Legendre quadrature points\n");
    exit(-1);
  }

  // Return points in appropriate domains
  double shift = (b+a)/2.0;
  double scale = (b-a)/2.0;
  for ( int n = 0; n < npoints; n++ ) {
    y[n] = scale*x[n] + shift;
    z[n] = (y[n]-a)/(b-a);
    w[n] = w[n]/2.0;
  }
}

/*
  Return laguerre quadrature points and weights
*/
void GaussianQuadrature::laguerreQuadrature(int npoints, 
                                            double mu, double beta, 
                                            double *z, double *y, double *w){
  double x[npoints];
  if ( npoints == 1 ){
    // points
    x[0] = 1.0;
    // weights
    w[0] = 1.0;
  } else if ( npoints == 2 ){
    // points
    x[0] = 0.585786437626905;
    x[1] = 3.414213562373095;
    // weights
    w[0] = 0.8535533905932737;
    w[1] = 0.14644660940672624;
  } else if ( npoints == 3 ){
    // points
    x[0] = 0.4157745567834791;
    x[1] = 2.294280360279042;
    x[2] = 6.2899450829374794;
    // weights
    w[0] = 0.7110930099291729;
    w[1] = 0.278517733569241;
    w[2] = 0.010389256501586133;
  } else if ( npoints == 4 ){
    // points
    x[0] = 0.3225476896193924;
    x[1] = 1.7457611011583465;
    x[2] = 4.536620296921128;
    x[3] = 9.395070912301133;
    // weights
    w[0] = 0.6031541043416337;
    w[1] = 0.35741869243779956;
    w[2] = 0.038887908515005405;
    w[3] = 0.0005392947055613296;
  } else if ( npoints == 5 ){
    // points
    x[0] = 0.26356031971814087;
    x[1] = 1.4134030591065168;
    x[2] = 3.596425771040722;
    x[3] = 7.085810005858837;
    x[4] = 12.640800844275782;
    // weights
    w[0] = 0.5217556105828085;
    w[1] = 0.398666811083176;
    w[2] = 0.07594244968170769;
    w[3] = 0.0036117586799220545;
    w[4] = 2.3369972385776248e-05;
  } else if ( npoints == 6 ){
    // points
    x[0] = 0.2228466041792607;
    x[1] = 1.1889321016726226;
    x[2] = 2.992736326059314;
    x[3] = 5.77514356910451;
    x[4] = 9.83746741838259;
    x[5] = 15.982873980601703;
    // weights
    w[0] = 0.45896467394996476;
    w[1] = 0.41700083077212;
    w[2] = 0.11337338207404488;
    w[3] = 0.010399197453149087;
    w[4] = 0.00026101720281493265;
    w[5] = 8.985479064296213e-07;
  } else if ( npoints == 7 ){
    // points
    x[0] = 0.19304367656036225;
    x[1] = 1.0266648953391924;
    x[2] = 2.567876744950746;
    x[3] = 4.900353084526484;
    x[4] = 8.18215344456286;
    x[5] = 12.734180291797815;
    x[6] = 19.39572786226254;
    // weights
    w[0] = 0.40931895170127336;
    w[1] = 0.4218312778617202;
    w[2] = 0.1471263486575053;
    w[3] = 0.020633514468716942;
    w[4] = 0.001074010143280746;
    w[5] = 1.5865464348564196e-05;
    w[6] = 3.1703154789955624e-08;
  } else if ( npoints == 8 ){
    // points
    x[0] = 0.17027963230510093;
    x[1] = 0.90370177679938;
    x[2] = 2.251086629866131;
    x[3] = 4.266700170287659;
    x[4] = 7.0459054023934655;
    x[5] = 10.758516010180996;
    x[6] = 15.740678641278004;
    x[7] = 22.863131736889265;
    // weights
    w[0] = 0.36918858934163495;
    w[1] = 0.4187867808143447;
    w[2] = 0.17579498663717255;
    w[3] = 0.033343492261215794;
    w[4] = 0.0027945362352256834;
    w[5] = 9.076508773358139e-05;
    w[6] = 8.48574671627257e-07;
    w[7] = 1.0480011748715153e-09;
  } else if ( npoints == 9 ){
    // points
    x[0] = 0.1523222277318084;
    x[1] = 0.8072200227422562;
    x[2] = 2.005135155619347;
    x[3] = 3.783473973331233;
    x[4] = 6.204956777876613;
    x[5] = 9.372985251687576;
    x[6] = 13.466236911092095;
    x[7] = 18.833597788991696;
    x[8] = 26.374071890927375;
    // weights
    w[0] = 0.33612642179796287;
    w[1] = 0.4112139804239856;
    w[2] = 0.1992875253708841;
    w[3] = 0.04746056276565138;
    w[4] = 0.005599626610794551;
    w[5] = 0.00030524976709320943;
    w[6] = 6.592123026075329e-06;
    w[7] = 4.1107693303495754e-08;
    w[8] = 3.290874030350679e-11;
  } else if ( npoints == 10 ){
    // points
    x[0] = 0.1377934705404926;
    x[1] = 0.729454549503171;
    x[2] = 1.8083429017403159;
    x[3] = 3.4014336978548996;
    x[4] = 5.552496140063804;
    x[5] = 8.330152746764497;
    x[6] = 11.843785837900066;
    x[7] = 16.279257831378104;
    x[8] = 21.99658581198076;
    x[9] = 29.92069701227389;
    // weights
    w[0] = 0.3084411157650173;
    w[1] = 0.4011199291552761;
    w[2] = 0.2180682876118096;
    w[3] = 0.062087456098677773;
    w[4] = 0.0095015169751811;
    w[5] = 0.0007530083885875384;
    w[6] = 2.8259233495995642e-05;
    w[7] = 4.249313984962698e-07;
    w[8] = 1.839564823979633e-09;
    w[9] = 9.91182721960906e-13;
  } else if ( npoints == 11 ){

    x[0] = 0.12579644218796757;
    x[1] = 0.6654182558392279;
    x[2] = 1.6471505458721691;
    x[3] = 3.091138143035255;
    x[4] = 5.029284401579833;
    x[5] = 7.509887863806617;
    x[6] = 10.605950999546968;
    x[7] = 14.431613758064186;
    x[8] = 19.17885740321468;
    x[9] = 25.217709339677562;
    x[10] = 33.49719284717553;

    w[0] = 0.28493321289419904;
    w[1] = 0.38972088952785106;
    w[2] = 0.23278183184899082;
    w[3] = 0.07656445354619705;
    w[4] = 0.014393282767350744;
    w[5] = 0.0015188808464848761;
    w[6] = 8.513122435471927e-05;
    w[7] = 2.2924038795745057e-06;
    w[8] = 2.4863537027677806e-08;
    w[9] = 7.712626933691416e-11;
    w[10] = 2.8837758683235913e-14;

  } else if ( npoints == 12 ){

    x[0] = 0.10714238847225208;
    x[1] = 0.5661318990404021;
    x[2] = 1.3985643364510194;
    x[3] = 2.616597108406411;
    x[4] = 4.2388459290170335;
    x[5] = 6.292256271140074;
    x[6] = 8.815001941186978;
    x[7] = 11.861403588811243;
    x[8] = 15.510762037703753;
    x[9] = 19.88463566388023;
    x[10] = 25.185263864677758;
    x[11] = 31.800386301947267;
    x[12] = 40.72300866926558;

    w[0] = 0.24718870842995047;
    w[1] = 0.36568882290052845;
    w[2] = 0.25256242005766244;
    w[3] = 0.1034707580241851;
    w[4] = 0.02643275441556194;
    w[5] = 0.004220396040254825;
    w[6] = 0.00041188177047274074;
    w[7] = 2.3515473981553592e-05;
    w[8] = 7.317311620249228e-07;
    w[9] = 1.1088416257040026e-08;
    w[10] = 6.770826692205984e-11;
    w[11] = 1.159979959905093e-13;
    w[12] = 2.2450932038927516e-17;

  } else if ( npoints == 14 ){

    x[0] = 0.09974750703259747;
    x[1] = 0.5268576488519032;
    x[2] = 1.3006291212514964;
    x[3] = 2.4308010787308443;
    x[4] = 3.9321028222932184;
    x[5] = 5.825536218301709;
    x[6] = 8.140240141565144;
    x[7] = 10.91649950736602;
    x[8] = 14.21080501116129;
    x[9] = 18.104892220218098;
    x[10] = 22.723381628269625;
    x[11] = 28.272981723248204;
    x[12] = 35.149443660592425;
    x[13] = 44.366081711117424;

    w[0] = 0.23181557714485496;
    w[1] = 0.3537846915975482;
    w[2] = 0.25873461024543143;
    w[3] = 0.11548289355692445;
    w[4] = 0.03319209215933767;
    w[5] = 0.006192869437006678;
    w[6] = 0.0007398903778673914;
    w[7] = 5.490719466841746e-05;
    w[8] = 2.409585764085411e-06;
    w[9] = 5.801543981676581e-08;
    w[10] = 6.819314692485005e-10;
    w[11] = 3.221207751894856e-12;
    w[12] = 4.221352440516672e-15;
    w[13] = 6.052375022289209e-19;

  } else if ( npoints == 15 ){

    x[0] = 0.09330781201728192;
    x[1] = 0.4926917403018839;
    x[2] = 1.2155954120709496;
    x[3] = 2.2699495262037437;
    x[4] = 3.667622721751437;
    x[5] = 5.425336627413554;
    x[6] = 7.565916226613068;
    x[7] = 10.120228568019114;
    x[8] = 13.130282482175724;
    x[9] = 16.65440770832996;
    x[10] = 20.77647889944877;
    x[11] = 25.62389422672878;
    x[12] = 31.40751916975394;
    x[13] = 38.53068330648601;
    x[14] = 48.026085572685794;

    w[0] = 0.2182348859400943;
    w[1] = 0.34221017792287955;
    w[2] = 0.2630275779416778;
    w[3] = 0.12642581810592993;
    w[4] = 0.04020686492100045;
    w[5] = 0.008563877803611772;
    w[6] = 0.0012124361472142422;
    w[7] = 0.00011167439234425123;
    w[8] = 6.459926762022831e-06;
    w[9] = 2.2263169070962413e-07;
    w[10] = 4.227430384979312e-09;
    w[11] = 3.9218972670410663e-11;
    w[12] = 1.4565152640730893e-13;
    w[13] = 1.4830270511133122e-16;
    w[14] = 1.6005949062110965e-20;

  } else if ( npoints == 16 ){

    x[0] = 0.08764941047892776;
    x[1] = 0.4626963289150804;
    x[2] = 1.1410577748312265;
    x[3] = 2.1292836450983805;
    x[4] = 3.4370866338932067;
    x[5] = 5.078018614549768;
    x[6] = 7.070338535048234;
    x[7] = 9.438314336391938;
    x[8] = 12.21422336886616;
    x[9] = 15.441527368781617;
    x[10] = 19.180156856753136;
    x[11] = 23.515905693991908;
    x[12] = 28.57872974288214;
    x[13] = 34.58339870228662;
    x[14] = 41.94045264768833;
    x[15] = 51.70116033954332;

    w[0] = 0.2061517149578049;
    w[1] = 0.3310578549508783;
    w[2] = 0.2657957776442144;
    w[3] = 0.13629693429637874;
    w[4] = 0.04732892869412563;
    w[5] = 0.011299900080339598;
    w[6] = 0.0018490709435263271;
    w[7] = 0.0002042719153082809;
    w[8] = 1.4844586873981502e-05;
    w[9] = 6.828319330871331e-07;
    w[10] = 1.8810248410797222e-08;
    w[11] = 2.862350242973897e-10;
    w[12] = 2.1270790332241214e-12;
    w[13] = 6.29796700251788e-15;
    w[14] = 5.050473700035608e-18;
    w[15] = 4.161462370372851e-22;

  } else if ( npoints == 17 ){

    x[0] = 0.07816916666970553;
    x[1] = 0.4124900852591291;
    x[2] = 1.0165201796235392;
    x[3] = 1.894888509969761;
    x[4] = 3.05435311320266;
    x[5] = 4.5042055388898925;
    x[6] = 6.256725073949111;
    x[7] = 8.32782515660563;
    x[8] = 10.73799004775761;
    x[9] = 13.51365620755509;
    x[10] = 16.689306281930104;
    x[11] = 20.310767626267744;
    x[12] = 24.4406813592837;
    x[13] = 29.168208662579616;
    x[14] = 34.627927065660174;
    x[15] = 41.04181677280876;
    x[16] = 48.83392271608652;
    x[17] = 59.09054643590125;

    w[0] = 0.1855886031469319;
    w[1] = 0.3101817663702191;
    w[2] = 0.26786656714853346;
    w[3] = 0.15297974746807239;
    w[4] = 0.06143491786096046;
    w[5] = 0.017687213080772597;
    w[6] = 0.003660179767759848;
    w[7] = 0.0005406227870077252;
    w[8] = 5.6169650512141573e-05;
    w[9] = 4.0153078837011224e-06;
    w[10] = 1.9146698566756363e-07;
    w[11] = 5.836095268631481e-09;
    w[12] = 1.0717112669553731e-10;
    w[13] = 1.089098713888804e-12;
    w[14] = 5.3866647483783116e-15;
    w[15] = 1.0498659780356833e-17;
    w[16] = 5.405398451631025e-21;
    w[17] = 2.6916532692009873e-25;

  } else if ( npoints == 19 ){

    x[0] = 0.07415878375720486;
    x[1] = 0.391268613319995;
    x[2] = 0.9639573439979584;
    x[3] = 1.796175582068328;
    x[4] = 2.893651381873784;
    x[5] = 4.264215539627767;
    x[6] = 5.918141561644048;
    x[7] = 7.868618915334735;
    x[8] = 10.132423716815266;
    x[9] = 12.730881463842397;
    x[10] = 15.691278339835888;
    x[11] = 19.04899320982355;
    x[12] = 22.850849760829483;
    x[13] = 27.160669327411448;
    x[14] = 32.06912225186224;
    x[15] = 37.71290580121965;
    x[16] = 44.3173627958315;
    x[17] = 52.312902457404384;
    x[18] = 62.80242315350038;

    w[0] = 0.17676847491590483;
    w[1] = 0.3004781436072563;
    w[2] = 0.26759954703817723;
    w[3] = 0.1599133721355825;
    w[4] = 0.06824937997615013;
    w[5] = 0.021239307606544574;
    w[6] = 0.004841627351148447;
    w[7] = 0.0008049127473813773;
    w[8] = 9.652472093153588e-05;
    w[9] = 8.20730525805109e-06;
    w[10] = 4.830566724730854e-07;
    w[11] = 1.9049913611232925e-08;
    w[12] = 4.816684630928075e-10;
    w[13] = 7.348258839551234e-12;
    w[14] = 6.202275387572623e-14;
    w[15] = 2.5414308430154715e-16;
    w[16] = 4.0788612968257876e-19;
    w[17] = 1.7077501875939235e-22;
    w[18] = 6.715064649908e-27;

  } else if ( npoints == 20 ){

    x[0] = 0.07053988969198874;
    x[1] = 0.37212681800161157;
    x[2] = 0.9165821024832738;
    x[3] = 1.7073065310283435;
    x[4] = 2.749199255309432;
    x[5] = 4.048925313850888;
    x[6] = 5.615174970861617;
    x[7] = 7.459017453671063;
    x[8] = 9.594392869581098;
    x[9] = 12.038802546964316;
    x[10] = 14.81429344263074;
    x[11] = 17.948895520519375;
    x[12] = 21.47878824028501;
    x[13] = 25.451702793186904;
    x[14] = 29.93255463170061;
    x[15] = 35.013434240479;
    x[16] = 40.83305705672857;
    x[17] = 47.6199940473465;
    x[18] = 55.810795750063896;
    x[19] = 66.52441652561575;

    w[0] = 0.1687468018511337;
    w[1] = 0.2912543620060606;
    w[2] = 0.2666861028669966;
    w[3] = 0.16600245326950186;
    w[4] = 0.07482606466879074;
    w[5] = 0.02496441730928259;
    w[6] = 0.0062025508445721095;
    w[7] = 0.0011449623864768774;
    w[8] = 0.00015574177302780828;
    w[9] = 1.5401440865224536e-05;
    w[10] = 1.086486366517955e-06;
    w[11] = 5.33012090955661e-08;
    w[12] = 1.7579811790505475e-09;
    w[13] = 3.725502402512163e-11;
    w[14] = 4.76752925157805e-13;
    w[15] = 3.3728442433624615e-15;
    w[16] = 1.1550143395003684e-17;
    w[17] = 1.5395221405823035e-20;
    w[18] = 5.286442725568928e-24;
    w[19] = 1.6564566124990854e-28;

  } else {
    printf("Error: Implement Laguerre quadrature points\n");
    exit(-1);        
  }

  // Return points in appropriate domains
  for ( int n = 0; n < npoints; n++ ) {
    y[n] = mu + beta*x[n];
    z[n] = x[n];
  }
}

void test(int argc, char *argv[] ){

  // Create quadrature object
  GaussianQuadrature *gaussQuad = new GaussianQuadrature();
  
  // Allocate memory on heap
  int npoints = 10;
  double *z = new double[npoints];
  double *y = new double[npoints];
  double *w = new double[npoints];

  // Hermite Quadrature
  double mun = 0.0;
  double sigman = 1.0;
  gaussQuad->hermiteQuadrature(npoints, mun, sigman, 
                               &z[0], &y[0], &w[0]);  
  printf("Hermite Quadrature\n");
  double wsum = 0.0;
  for ( int i = 0 ; i < npoints; i++ ){
    wsum += w[i];
    printf("%d %15.6f %15.6f %15.6f %15.6f\n", i, z[i], y[i], w[i], wsum);
  }

  // Legendre Quadrature
  double a = 0.0;
  double b = 1.0;
  gaussQuad->legendreQuadrature(npoints, a, b, 
                                &z[0], &y[0], &w[0]);  
  printf("\nLegendre Quadrature\n");
  wsum = 0.0;
  for ( int i = 0 ; i < npoints; i++ ){
    wsum += w[i];
    printf("%d %15.6f %15.6f %15.6f %15.6f\n", i, z[i], y[i], w[i], wsum);
  }

  // Laguerre Quadrature
  double mu = 0.0;
  double beta = 1.0;
  gaussQuad->laguerreQuadrature(npoints, mu, beta, 
                                &z[0], &y[0], &w[0]);  
  printf("\nLaguerre Quadrature\n");
  wsum = 0.0;
  for ( int i = 0 ; i < npoints; i++ ){
    wsum += w[i];
    printf("%d %15.6f %15.6f %15.6f %15.6f\n", i, z[i], y[i], w[i], wsum);
  }

  // Free allocated heap memory
  delete gaussQuad;
  delete[] z;
  delete[] y;
  delete[] w;
}

